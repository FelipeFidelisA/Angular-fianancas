{"ast":null,"code":"import { Injector } from '@angular/core';\nimport { flatMap, catchError, map } from \"rxjs/operators\";\nimport { BaseResourceService } from \"../../../shared/services/base-resource.service\";\nimport { CategoryService } from \"../../categories/shared/category.service\";\nimport { Entry } from \"./entry.model\";\nimport * as moment from \"moment\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../categories/shared/category.service\";\nexport let EntryService = /*#__PURE__*/(() => {\n  class EntryService extends BaseResourceService {\n    constructor(injector, categoryService) {\n      super(\"api/entries\", injector, Entry.fromJson);\n      this.injector = injector;\n      this.categoryService = categoryService;\n    }\n    create(entry) {\n      return this.setCategoryAndSendToServer(entry, super.create.bind(this));\n    }\n    update(entry) {\n      return this.setCategoryAndSendToServer(entry, super.update.bind(this));\n    }\n    getByMonthAndYear(month, year) {\n      return this.getAll().pipe(map(entries => this.filterByMonthAndYear(entries, month, year)));\n    }\n    setCategoryAndSendToServer(entry, sendFn) {\n      return this.categoryService.getById(entry.categoryId).pipe(flatMap(category => {\n        entry.category = category;\n        return sendFn(entry);\n      }), catchError(this.handleError));\n    }\n    filterByMonthAndYear(entries, month, year) {\n      return entries.filter(entry => {\n        const entryDate = moment(entry.date, \"DD/MM/YYYY\");\n        const monthMatches = entryDate.month() + 1 == month;\n        const yearMatches = entryDate.year() == year;\n        if (monthMatches && yearMatches) return entry;\n      });\n    }\n  }\n  EntryService.ɵfac = function EntryService_Factory(t) {\n    return new (t || EntryService)(i0.ɵɵinject(i0.Injector), i0.ɵɵinject(i1.CategoryService));\n  };\n  EntryService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: EntryService,\n    factory: EntryService.ɵfac,\n    providedIn: 'root'\n  });\n  return EntryService;\n})();","map":null,"metadata":{},"sourceType":"module"}